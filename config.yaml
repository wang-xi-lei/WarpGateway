# WarpGateway 配置文件

proxy:
  # 代理监听地址
  host: "0.0.0.0"
  # 代理端口
  port: 8080
  # 默认上游代理（所有请求都走，可留空）
  # 配置为 Clash VPN 代理（端口 7890）
  upstream: "http://127.0.0.1:7890"
  # 条件路由：特定 URL 走上游代理（如果 upstream 已设置，此项通常不需要）
  upstream_routes:
    # 如果需要特定域名走不同的代理，可以在这里配置
    # - pattern: "example.com"
    #   upstream: "http://127.0.0.1:其他端口"
    # 可添加更多路由
  # 是否启用 SSL 拦截
  ssl_insecure: false

# 拦截规则配置
rules:
  # 拦截的请求（返回 403）
  block:
    # Warp Sentry 错误上报
    - "o540343.ingest.sentry.io"
    # Warp 数据分析
    - "dataplane.rudderstack.com"
    # Warp 应用内分析和代理
    - "app.warp.dev/analytics/block"
    - "app.warp.dev/proxy/sentry"
    # 其他可选拦截（取消注释以启用）
    # - "api.warp.dev/v1/billing"
    # - "api.warp.dev/v1/subscription"
  
  # 允许通过的请求
  allow: []
  
  # 仅记录日志但不拦截
  log_only: []

# 流式响应配置
streaming:
  # 需要启用流式响应的路径
  paths:
    - "/ai/multi-agent"      # Warp AI 多智能体对话

# 日志配置
logging:
  # 日志级别: DEBUG, INFO, WARNING, ERROR
  level: "INFO"
  # 日志文件路径
  file: "warp_gateway.log"
  # 是否输出到控制台
  console: true

# API 分析配置
analysis:
  # 是否启用详细分析日志
  enabled: true
  # Warp.dev 相关域名列表（只记录这些域名的请求）
  domains:
    - "api.warp.dev"
    - "app.warp.dev"
    - "warp.dev"
  # 请求体最大记录大小（字节，默认 1MB）
  max_body_size: 1048576
  # 是否脱敏敏感信息
  mask_sensitive: true
  # 需要脱敏的 Header 列表
  sensitive_headers:
    - "Authorization"
    - "X-API-Key"
    - "X-Auth-Token"
    - "Cookie"
